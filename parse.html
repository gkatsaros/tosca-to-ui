<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="add-member.json"></script>
<body>

<h2 id="header"></h2>

<p id="description"></p>


<form name="dynamicForm" id="submit-form">
   <input type="Submit"  value="Submit" id="but"/>
   <br /><br />
</form>


<script>

var bp = 'add-member.json';


$.getJSON(bp, function(json) {
     
    console.log(json); // this will show the info it in firebug console

    var h2 = document.getElementById("header");
    //var descr = document.getElementById("description");
    
    document.getElementById("description").innerHTML = json.description;

    var form = window.document.dynamicForm;
    var but = document.getElementById("but");

    var inputs = json.inputs;
    for (field in inputs) {
    console.log(field);

    var title = document.createTextNode(field.concat(' : '));
    var input_field = document.createElement("input");
    input_field.name = field;
    input_field.type = "text";
    input_field.value = inputs[field].default;

    var bloc = document.createElement("p");
 
    bloc.appendChild(input_field);
    
    form.insertBefore(input_field, but);
    form.insertBefore(bloc, but);
    form.insertBefore(title, input_field);
}


});

// Attach a submit handler to the form
$("#submit-form").submit(function( event ) {
 
  // Stop form from submitting normally
  event.preventDefault();
 
  // Get some values from elements on the page:
  //var $form = $( this ),
  //  term = $form.find( "input[name='s']" ).val(),
  url = "http://dev.cloudify2.int.foobarservices.com/api/v3.1/deployments/add-member-tst?_include=id";
  url_post = "http://dev.cloudify2.int.foobarservices.com/api/v3.1/executions?_include=id";
  // Send the data using post
  //var posting = $.post( url, { s: term } );
 

  // curl -X PUT \
  //  --header "Tenant: <manager-tenant>" \
  //  --header "Content-Type: application/json" \
  //  -u <manager-username>:<manager-password> \
  //  -d '{"blueprint_id": "<blueprint-id>", "inputs": {...}, "visibility": "<visibility>"}' \
  //  "http://<manager-ip>/api/v3.1/deployments/<deployment-id>?_include=id"
  
  $.ajax({
         url: url,    //Your api url
         type: 'PUT',   //type is any HTTP method
         //data: {
         //       data: sendData
         //      },      //Data as js object
         data: JSON.stringify({ "blueprint_id": "add-infoblox-member", "inputs":{"infoblox_member_gateway":"172.31.16.1", "infoblox_member_ip":"172.31.31.31","infoblox_member_name":"new_infoblox_member", "infoblox_public_endpoint":"35.178.32.158"}}),
         async: false,
         headers: { "Authorization": "Basic " + btoa('gregory.katsaros'+":"+"cdncvJ4cHVLEZvff"), "Tenant":"default_tenant", "Content-Type": "application/json"},
         success: function () {


$.ajax({
         url: url_post,    //Your api url
         type: 'POST',   //type is any HTTP method
         //data: {
         //       data: sendData
         //      },      //Data as js object
         data: JSON.stringify({ "deployment_id": "add-member-tst", "workflow_id":"install"}),
         async: false,
         headers: { "Authorization": "Basic " + btoa('gregory.katsaros'+":"+"cdncvJ4cHVLEZvff"), "Tenant":"default_tenant", "Content-Type": "application/json"},
         success: function () {
                    }
                });

                    }
                });
                 

   // curl -X POST \
   // --header "Tenant: <manager-tenant>" \
   // --header "Content-Type: application/json" \
   // -u <manager-username>:<manager-password> \
   // -d '{"deployment_id": "<deployment-id>", "workflow_id": "install"}' \
   // "http://<manager_ip>/api/v3.1/executions?_include=id"


  // Put the results in a div
  //posting.done(function( data ) {
  //  var content = $( data ).find( "#content" );
  //  $( "#result" ).empty().append( content );
 // });
});

</script>

</body>
</html> 

